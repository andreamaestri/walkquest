@tailwind base;

@layer base {
    /* Root Custom Properties */
    :root {
        --quick-letter-scale: 1.2;
        --quick-letter-hover-scale: 1.8;
        --quick-letter-spacing: 0.5rem;
    }

    @screen sm {
        :root {
            --quick-letter-scale: 1;
            --quick-letter-hover-scale: 1.4;
            --quick-letter-spacing: 0.25rem;
        }
    }

    /* Font Face */
    @font-face {
        font-family: 'Work Sans Variable';
        font-style: normal;
        font-display: swap;
        font-weight: 100 900;
        src: url(https://cdn.jsdelivr.net/fontsource/fonts/work-sans:vf@latest/latin-wght-normal.woff2) format('woff2-variations');
        unicode-range: U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;
    }

    /* Scrollbar Styles */
    * {
        scrollbar-width: thin;
        scrollbar-color: hsl(var(--p)/0.3) transparent;
    }

    *::-webkit-scrollbar {
        @apply w-1.5 h-1.5;
    }

    *::-webkit-scrollbar-track {
        @apply bg-transparent;
    }

    *::-webkit-scrollbar-thumb {
        @apply bg-primary/30 rounded-full hover:bg-primary/50 transition-colors;
    }

    /* Base Layout */
    html, body {
        @apply h-full;
    }

    main {
        @apply h-full overflow-y-auto;
    }

    /* Interactive Elements */
    button, a, input, select, textarea {
        @apply relative z-10;
    }
}

@tailwind components;

@layer components {
    /* Calendar Component */
    .fc {
        --fc-border-color: hsl(var(--b3));
        --fc-button-text-color: hsl(var(--pc));
        --fc-button-bg-color: hsl(var(--p));
        --fc-button-border-color: hsl(var(--p));
        --fc-button-hover-bg-color: hsl(var(--pf));
        --fc-button-hover-border-color: hsl(var(--pf));
        --fc-button-active-bg-color: hsl(var(--pf));
        --fc-button-active-border-color: hsl(var(--pf));
    }

    /* Navigation and Interactive Elements */
    .nav-item {
        @apply relative overflow-visible transform-gpu transition-all duration-300;
        @apply hover:ring-2 hover:ring-primary/50 hover:ring-offset-1 hover:ring-offset-base-100 hover:scale-105;
        @apply focus:outline-none focus:ring-2 focus:ring-primary;
        transform-style: preserve-3d;
        backface-visibility: hidden;
    }

    .nav-item-indicator {
        @apply absolute bottom-0 left-0 right-0 h-0.5 bg-current transform scale-x-0 transition-transform duration-300;
    }

    /* Theme and User Elements */
    .theme-preview {
        @apply w-6 h-6 rounded-full border-2 border-base-content/20 relative;
    }

    .theme-preview-gradient {
        @apply absolute inset-[2px] rounded-full bg-gradient-to-tr from-primary to-secondary;
    }

    .user-avatar-status {
        @apply absolute -bottom-0.5 -right-0.5 w-2.5 h-2.5 rounded-full bg-success border-2 border-base-200;
    }

    /* Table Styles */
    .table-container {
        @apply relative overflow-y-auto touch-pan-y;
    }

    .table-header-sticky {
        @apply sticky top-0 z-10 backdrop-blur-lg bg-base-100/95;
    }

    /* Tom Select Styles */
    .ts-wrapper {
        @apply relative w-full;
    }

    .ts-control {
        @apply min-h-[3rem] px-3 py-2 bg-base-100 border border-base-300 rounded-xl;
        @apply flex flex-wrap items-center gap-2;
        @apply cursor-pointer hover:border-primary/50 transition-colors duration-200;
    }

    /* Quick Letters Component */
    .quick-letters-list {
        @apply fixed flex flex-col items-center;
        height: calc(100vh - 24rem);
        max-height: 32rem;
        width: 3rem;
        font-size: 0.75rem;
        line-height: 1;
        z-index: 30;
        padding: 0.5rem 0;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
        right: 0.25rem; /* Closer to edge on mobile */

        @screen sm {
            right: 1.5rem; /* Original spacing for larger screens */
        }
    }

    .quick-letter {
        @apply flex items-center justify-center text-base-content/50;
        height: calc(100% / 26);
        min-height: 1rem;
        width: 100%;
        padding: 0;
        font-weight: 500;
        transform-origin: center right;
        position: relative;
        pointer-events: auto;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        will-change: transform, color, opacity;
    }

    .quick-letter::before {
        content: '';
        @apply absolute;
        width: 300%;
        height: 100%;
        left: -200%;
        top: 0;
    }

    .quick-letter:hover:not(.active) {
        @apply text-primary;
        transform: scale(1.2);
        transition-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1);
        transition-duration: 0.2s;
    }

    .quick-letter.active {
        @apply text-primary font-bold;
        transform: scale(1.4);
    }

    .quick-letter.active + .quick-letter,
    .quick-letter:has(+ .quick-letter.active) {
        transform: scale(1.1);
        @apply text-primary/70;
        transition-duration: 0.1s;
    }

    .quick-letter.adjacent {
        @apply text-primary/70;
        transform: scale(1.1);
    }

    /* Letter Preview and Magnifier */
    .letter-magnifier, .letter-preview {
        display: none;
    }

    .modal[open] .letter-magnifier,
    .modal[open] .letter-preview {
        display: block;
    }

    /* Skills Container */
    .skill-container {
        @apply relative border border-base-300 rounded-xl;
        @apply transition-all duration-200;
        @apply cursor-pointer min-h-[8rem];
        @apply hover:border-primary/30 hover:bg-base-200/10;
    }

    /* Empty state styling */
    .empty-state {
        @apply transition-all duration-200;
        @apply pointer-events-none;
    }

    .skill-container:hover .empty-state {
        @apply text-primary/70;
    }

    .skill-container:has(#selected-skills:not(:empty)) .empty-state {
        display: none;
    }

    #selected-skills {
        @apply relative z-10;
        min-height: 1.5rem;
    }

    /* Mobile styles */
    @screen sm {
        .skill-container {
            min-height: 5rem;
        }
    }

    /* Adjust modal content to accommodate preview */
    .modal-box .overflow-y-auto {
        @apply relative;
        backdrop-filter: blur(8px);
    }

    /* Add subtle animation for letter groups when preview is visible */
    .skill-group[data-letter] {
        @apply transition-all duration-300;
    }

    .letter-preview.visible ~ .skill-group[data-letter] {
        @apply backdrop-blur-sm bg-base-100/50;
    }

    /* Skill Group */
    .skill-group {
        @apply touch-pan-y overscroll-contain;
        scroll-margin-top: 0;
        padding-right: 4rem;
        margin-bottom: 1rem;
    }

    .skill-group-header {
        @apply sticky top-0 z-20 bg-base-100/25 border-b border-base-200/10;
        transform-style: preserve-3d;
    }

    .skill-group-label {
        @apply transition-all duration-200;
    }

    .skill-group-label--hover {
        @apply hover:-translate-y-0.5 hover:shadow-lg;
    }

    /* Modal Styles */
    .modal-box {
        @apply relative w-full h-full mx-auto;
        @apply bg-base-100 rounded-2xl shadow-xl;
        @apply p-6 overflow-hidden;
        @apply transition-all duration-300 ease-out;
        
        /* Ensure full screen on mobile */
        width: 100vw;
        height: 100dvh;
        max-height: 100dvh;
        margin: 0;
        border-radius: 0;
        padding: 0;
    }

    /* Restore desktop styles */
    @screen sm {
        .modal-box {
            width: 91.666667%; /* w-11/12 */
            height: 85vh;
            max-width: 80rem; /* max-w-7xl */
            margin: auto;
            border-radius: 1rem;
        }
    }

    .modal-box--mobile {
        @apply fixed inset-0 m-0 rounded-none;
        @apply h-[100dvh] max-h-none;
        @apply flex flex-col;
    }

    .modal .btn {
        @apply relative overflow-hidden;
        @apply active:scale-95 transition-transform;
    }

    .modal .btn-primary {
        @apply shadow-md shadow-primary/20;
        @apply hover:shadow-lg hover:shadow-primary/30;
        @apply active:shadow-sm;
    }

    .modal .btn iconify-icon {
        @apply transition-transform duration-200;
    }

    .modal .btn:hover iconify-icon {
        @apply scale-110;
    }

    .modal-box .flex-none {
        @apply backdrop-blur-xl bg-base-100/90;
    }

    /* Add these backdrop button styles */
    .modal-backdrop button {
        @apply opacity-0 absolute;
        pointer-events: none;
    }

    /* Keep the backdrop itself clickable */
    .modal-backdrop {
        @apply cursor-pointer;
    }

    /* Skills Container and Placeholder */
    .form-control .skill-container {
        @apply relative border border-base-300 rounded-xl;
        min-height: 8rem; /* Taller on mobile */
        padding: 4rem;
        
        @screen sm {
            min-height: 5rem; /* Original height on desktop */
        }
    }

    .form-control .skill-container .add-skills-button {
        @apply absolute bottom-3 left-3 right-3;
        @apply btn btn-outline btn-primary btn-sm w-auto;
        @apply sm:hidden; /* Only show on mobile */
    }

    .form-control #selected-skills {
        @apply relative flex flex-wrap gap-2 z-10;
        min-height: 1.5rem;
    }

    .form-control #skills-placeholder {
        @apply absolute inset-0 flex items-center justify-center;
        opacity: 1 !important;
        color: hsl(var(--bc) / 0.5) !important;
        pointer-events: none;
        z-index: 0;
    }

    .form-control .skill-container:hover #skills-placeholder {
        color: hsl(var(--p) / 0.7) !important;
    }

    /* Only hide placeholder when skills are selected */
    .form-control #selected-skills:not(:empty) + #skills-placeholder {
        opacity: 0 !important;
    }

    /* Badge Styles */
    .badge {
        gap: 0.25rem;
    }

    .badge .btn-square {
        min-height: 1.5rem;
        height: 100%;
        width: 1.5rem;
        margin: -0.125rem -0.125rem -0.125rem 0;
    }

    .badge .btn-square:hover {
        background-color: currentColor;
    }

    /* Skills Container and Interactive Elements */
    .skill-container {
        @apply relative border border-base-300 rounded-xl p-4;
        @apply transition-all duration-200;
        min-height: 5rem;
    }

    /* Mobile bottom CTA */
    .mobile-skills-cta {
        @apply fixed bottom-0 left-0 right-0 p-4 bg-base-100;
        @apply border-t border-base-200 shadow-lg;
        @apply flex items-center justify-center;
        @apply transform transition-all duration-200;
        @apply z-50;
        @apply translate-y-full; /* Hidden by default */
    }

    .mobile-skills-cta .btn {
        @apply btn-primary w-full max-w-md;
    }

    /* Show mobile CTA when skills are selected */
    .has-skills .mobile-skills-cta {
        @apply translate-y-0;
    }

    /* Hide mobile CTA on desktop */
    @screen sm {
        .mobile-skills-cta {
            @apply hidden;
        }

        .skill-container {
            min-height: 5rem;
        }
    }

    /* Mobile-first CTA design */
    .skill-trigger {
        @apply absolute inset-0 flex items-center justify-center;
        @apply bg-primary/5 hover:bg-primary/10 active:bg-primary/15;
        @apply transition-all duration-200;
        @apply rounded-xl;
    }

    .skill-container:has(#selected-skills:not(:empty)) .skill-trigger {
        @apply bg-transparent hover:bg-base-200/50;
    }

    .add-skills-cta {
        @apply flex flex-col items-center justify-center gap-2 p-4;
        @apply text-primary/70 hover:text-primary;
        @apply transition-all duration-200;
    }

    .add-skills-cta iconify-icon {
        @apply text-4xl sm:text-3xl;
        @apply transition-transform duration-300;
    }

    .add-skills-cta span {
        @apply text-sm font-medium text-center;
        @apply sm:text-base;
    }

    /* Empty state highlight */
    .skill-container:not(:has(#selected-skills *)) .skill-trigger {
        @apply animate-pulse;
    }

    /* Active state feedback */
    .skill-trigger:active .add-skills-cta {
        @apply scale-95;
    }

    /* Selected skills styling */
    #selected-skills {
        @apply relative z-10 p-4 flex flex-wrap gap-2;
        min-height: 1.5rem;
    }

    /* Desktop hover refinements */
    @screen sm {
        .skill-trigger {
            @apply bg-transparent;
        }
        
        .skill-container:hover .skill-trigger {
            @apply bg-base-200/30;
        }
    }

    /* Mobile CTA styling */
    .mobile-cta {
        @apply fixed bottom-0 left-0 right-0;
        @apply p-4 bg-base-100 border-t border-base-200;
        @apply shadow-lg backdrop-blur-sm;
        @apply transform transition-all duration-300;
        @apply z-50;
        padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1rem);
        transform: translateY(100%);
    }

    /* Show CTA when skills are present */
    .has-skills .mobile-cta {
        transform: translateY(0);
    }

    /* Hide on desktop */
    @screen sm {
        .mobile-cta {
            @apply hidden;
        }
    }
}

@tailwind utilities;

@layer utilities {
    /* Animation Utilities */
    .animate-fade-in {
        animation: fadeIn 0.3s ease-out;
    }

    .animate-slide-up {
        animation: slideUp 0.3s ease-out;
    }

    .animate-scale-in {
        animation: scaleIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    /* Transform Utilities */
    .transition-gpu {
        @apply transform-gpu transition-all duration-200;
        backface-visibility: hidden;
        transform-style: preserve-3d;
        will-change: transform, opacity;
    }

    .backface-hidden {
        backface-visibility: hidden;
        transform-style: preserve-3d;
    }

    /* Smooth scroll utility */
    .smooth-scroll {
        scroll-behavior: smooth;
        transition: scroll-position 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        overscroll-behavior: none;
    }
}

/* Keyframes */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideUp {
    from { 
        opacity: 0;
        transform: translateY(1rem);
    }
    to { 
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes scaleIn {
    from { 
        opacity: 0;
        transform: scale(0.95);
    }
    to { 
        opacity: 1;
        transform: scale(1);
    }
}

@keyframes modal-enter {
    from {
        opacity: 0;
        transform: scale(0.95) translateY(10px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}